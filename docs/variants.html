<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Abrantes - Variant Functions</title>
    <meta name="description"
        content="Learn how Abrantes variants work and see JavaScript examples for changing text, classes, attributes, and more.">
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <header>
        <div class="container">
            <a href="index.html" class="logo">Abrantes</a>
            <div class="nav-links">
                <a href="index.html">Home</a>
                <a href="examples.html">Examples</a>
                <a href="docs.html">Documentation</a>
                <a href="https://github.com/osvik/abrantes" target="_blank" rel="noreferrer">GitHub</a>
            </div>
        </div>
    </header>

    <main>
        <section class="hero docs-hero">
            <div class="container">
                <h1>Defining variants in JavaScript</h1>
                <p class="subtitle">You define an array of functions that modify the page(s), one function per variant. When the experiment runs a random variant is assigned to the user and the corresponding function executes and modifies the page.</p>
                <div class="cta-group">
                    <a href="experiments.html" class="btn btn-secondary">Back to experiments</a>
                    <a href="examples.html" class="btn btn-secondary">Browse examples</a>
                </div>
            </div>
        </section>

        <section class="features docs-section">
            <div class="container">
                <h2>How variants work</h2>
                <div class="feature-card">
                    <p><code>MyTest.variants</code> is an array of functions. Each function describes the DOM changes
                        for one variant.</p>
                    <ul class="doc-list">
                        <li>The variant function runs when <code>MyTest.renderVariant()</code> is called, after a variant is assigned to the user.</li>
                        <li>Index <code>0</code> is the first variant, often the control/original. It can be an empty function or a baseline function.</li>
                        <li>If a user is excluded from the experiment, <code>MyTest.variant</code> is set to <code>-1</code> and no variant is rendered.</li>
                    </ul>
                    <pre><code>var MyTest = Object.create(Abrantes);

MyTest.variants = [
  function () { /* control or baseline changes */ },
  function () { document.querySelector(".cta").textContent = "Start free trial"; },
  function () { document.querySelector(".cta").textContent = "Get demo"; }
];

MyTest.assignVariant("MyTest");
MyTest.renderVariant();
</code></pre>
<p>You should carefully test all variants, in desktop and mobile, before publishing an experiment. During the testing you can pass the variant number as a parameter to the renderVariant method. For example <code>MyTest.renderVariant(1);</code></p>
                </div>
            </div>
        </section>

        <section class="features docs-section">
            <div class="container">
                <h2>Common DOM patterns</h2>
                <div class="doc-grid two-col">
                    <div class="feature-card">
                        <h3>Change text</h3>
                        <pre><code>function () {
  document.querySelector("h1").innerText = "MyTest Variant 1";
}
</code></pre>
                    </div>
                    <div class="feature-card">
                        <h3>Change HTML</h3>
                        <pre><code>function () {
  document.querySelector("h1").innerHTML =
    'MyTest &lt;span style="color: red;"&gt;Variant 1&lt;/span&gt;';
}
</code></pre>
                    </div>
                    <div class="feature-card">
                        <h3>Add or remove classes</h3>
                        <pre><code>function () {
  document.querySelectorAll("h1").forEach(function (el) {
    el.classList.add("large-header");
    el.classList.remove("d-none");
  });
}
</code></pre>
                    </div>
                    <div class="feature-card">
                        <h3>Set attributes</h3>
                        <pre><code>function () {
  document.querySelectorAll("h1").forEach(function (el) {
    el.setAttribute("data-variant", "MyTest Variant 2");
  });
}
</code></pre>
                    </div>
                    <div class="feature-card">
                        <h3>Hide elements</h3>
                        <pre><code>function () {
  document.querySelectorAll("h1").forEach(function (el) {
    el.style.display = "none";
    el.setAttribute("aria-hidden", "true");
  });
}
</code></pre>
                    </div>
                    <div class="feature-card">
                        <h3>Swap an image</h3>
                        <pre><code>function () {
  document.querySelectorAll("img").forEach(function (img) {
    var original = "example.jpg";
    var variant = "example-variant.jpg";
    if (img.src.includes(original)) {
      img.src = img.src.replace(original, variant);
      img.removeAttribute("srcset");
    }
  });
}
</code></pre>
                    </div>
                </div>
            </div>
        </section>

        <section class="features docs-section">
            <div class="container">
                <h2>Tips for clean variants</h2>
                <div class="feature-card">
                    <ul class="doc-list">
                        <li>Use specific CSS selectors so you only change what you intend.</li>
                        <li>Check for missing elements before updating them.</li>
                        <li>Keep the control in the base HTML and use an empty control function when needed.</li>
                        <li>For delayed content, or content not yet in the DOM, wrap changes in <code>MyTest.waitFor</code>.</li>
                    </ul>
                    <a class="doc-link" href="https://github.com/osvik/abrantes/blob/main/examples/waitFor.html#L35-L54" target="_blank">Open waitFor.html â†’</a><br />
                    <a class="doc-link" href="https://github.com/osvik/abrantes/blob/main/examples/example-functions.js"
                        target="_blank" rel="noreferrer">Open example-functions.js &rarr;</a>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>&copy; Abrantes. Open source software licensed under LGPL-3.0.</p>
            <p>Maintained by <a href="https://github.com/osvik" target="_blank" rel="noreferrer">osvik</a>.</p>
        </div>
    </footer>
</body>

</html>
